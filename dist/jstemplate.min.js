/*!
 * Simple JavaScript template engine
 * https://github.com/JoniJnm/jstemplate
 *
 * Copyright JoniJnm.es
 * Released under the GPL-2.0 license.
 *
 * Date: 2015-11-12
 */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define([],e):"undefined"!=typeof module&&module.exports?module.exports=e():t.jstemplate=e()}(this,function(){"use strict";var t=function(t){this.html=t,this.code="",this.startBlocks=["if","for","while","each"],this.continueBlocks=["else","else if","elseif"]};t.prototype={add:function(t){this.code+=t,this.code+="\n"},initCode:function(){this.add("with(data) {"),this.add('var html = "";')},endCode:function(){this.add("}"),this.add("return html;")},addRawHTML:function(t){this.add("html += "+JSON.stringify(t)+";")},addRawCode:function(t){this.add(t)},addReturnedCode:function(t){this.add("html += "+t+";")},addEachBlock:function(t){var e=t.match(/^each ([\w\._]+) as ([\w_]+)$/),n=e[1],i=e[2];this.add("for (var __i in "+n+") {"),this.add("if (!"+n+".hasOwnProperty(__i)) continue;"),this.add("var "+i+" = "+n+"[__i];")},addStartBlock:function(t){t=t.replace(/ /," ("),t+=") {",this.add(t)},addContinueBlock:function(t){this.addEndBlock(),"else"===t?this.add("else {"):(t=t.replace(/^else if/,"elseif"),t=t.replace(/ /," ("),t=t.replace(/^elseif/,"else if"),t+=") {",this.add(t))},addEndBlock:function(){this.add("}")},run:function(){this.initCode();var t=0,e=this.html,n=this;e.replace(/{(.*?)\}/g,function(i,d,o){n.addRawHTML(e.substr(t,o-t)),n.isEachBlock(d)?n.addEachBlock(d):n.isStartBlock(d)?n.addStartBlock(d):n.isContinueBlock(d)?n.addContinueBlock(d):n.isEndBlock(d)?n.addEndBlock(d):n.isUnreturnedCode(d)?n.addRawCode(d):n.addReturnedCode(d),t=o+i.length}),this.endCode()},isEachBlock:function(t){return 0===t.indexOf("each ")},isStartBlock:function(t){var e=new RegExp("^("+this.startBlocks.join("|")+")");return e.test(t)},isContinueBlock:function(t){var e=new RegExp("^("+this.continueBlocks.join("|")+")");return e.test(t)},isEndBlock:function(t){return"/"===t[0]},isUnreturnedCode:function(t){var e=t.replace(/'.*?'/g,"").replace(/".*?"/g);return-1!==e.indexOf("=")||-1!==e.indexOf("++")||-1!==e.indexOf("--")},getCode:function(){return this.code}};var e=function(e){var n=new t(e);n.run();var i=n.getCode(),d=new Function("data",i);return function(t){return d.call(null,t)}};return e});