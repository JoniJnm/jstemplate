/*!
* Simple JavaScript template engine
* https://github.com/JoniJnm/jstemplate
*
* Copyright JoniJnm.es
* Released under the GPL-2.0 license.
*
* Version: 1.3.1
* Date: 2015-12-09
*/
!function(e,t){"use strict";"function"==typeof define&&define.amd?define([],t):"undefined"!=typeof module&&module.exports?module.exports=t():e.jstemplate=t()}(this,function(){"use strict";var e=function(e){this.html=e,this.source="",this.startBlocks=["if","for","while","foreach"],this.continueBlocks=["else","else if","elseif"],this.reservedWords=["break","continue","debugger","var","let"],this.startBlockRegex=new RegExp("^("+this.startBlocks.join("|")+") "),this.continueBlockRegex=new RegExp("^("+this.continueBlocks.join("|")+")( |$)"),this.rawCodeRegexs=[new RegExp("^("+this.reservedWords.join("|")+")( |$)"),/^[\w\.$]+\s*=[^=]/,/^[\w\.$]+\s*(\+\+|\-\-)$/],this.eachRegex=/^foreach ([\w\._]+) as ([\w_]+)$/};e.prototype={add:function(e){this.source+=e,this.source+="\n"},initSource:function(){this.add("with(self) {"),this.add('var __html = "";')},getSource:function(){return this.source},endSource:function(){this.add("}"),this.add("return __html;")},addRawHTML:function(e){this.trim(e)&&(e=this.beauty(e),this.add("__html += "+JSON.stringify(e)+";"))},addForcedRawCode:function(e){this.addRawCode(e.substr(1))},addRawCode:function(e){this.add(e+";")},addForcedReturnedCode:function(e){this.addReturnedCode(e.substr(1))},addReturnedCode:function(e){this.add("__html += this.encode("+e+");")},addForcedReturnedRawCode:function(e){this.add("__html += "+e.substr(1)+";")},addEachBlock:function(e){var t=e.match(this.eachRegex),n=t[1],r=t[2];this.add("var _i = -1;"),this.add("for (var _key in "+n+") {"),this.add("if (!"+n+".hasOwnProperty(_key)) continue;"),this.add("_i++;"),this.add("var "+r+" = "+n+"[_key];")},addStartBlock:function(e){e=e.replace(/ /," ("),e+=") {",this.add(e)},addContinueBlock:function(e){this.addEndBlock(),"else"===e?this.add("else {"):(e=e.replace(/^else if/,"elseif"),e=e.replace(/ /," ("),e=e.replace(/^elseif/,"else if"),e+=") {",this.add(e))},addEndBlock:function(){this.add("}")},run:function(){this.initSource();var e=0,t=this.html,n=this;t=t.replace(/<script[^>]*>([\s\S]+?)<\/script>/g,function(e,t){return n.add(t),""}),t.replace(/\{([\s\S]+?)\}/g,function(r,i,o){return i=i.replace(/^ +/,"").replace(/ +$/,""),n.addRawHTML(t.substr(e,o-e)),n.isComment(i)||(n.isEachBlock(i)?n.addEachBlock(i):n.isStartBlock(i)?n.addStartBlock(i):n.isContinueBlock(i)?n.addContinueBlock(i):n.isEndBlock(i)?n.addEndBlock(i):n.isForcedRawCode(i)?n.addForcedRawCode(i):n.isForcedReturnCode(i)?n.addForcedReturnedCode(i):n.isForcedReturnRawCode(i)?n.addForcedReturnedRawCode(i):n.isRawCode(i)?n.addRawCode(i):n.addReturnedCode(i)),e=o+r.length,r}),this.endSource()},isEachBlock:function(e){return this.eachRegex.test(e)},isStartBlock:function(e){return this.startBlockRegex.test(e)},isContinueBlock:function(e){return this.continueBlockRegex.test(e)},isEndBlock:function(e){return"/"===e[0]},isForcedRawCode:function(e){return"#"===e[0]},isRawCode:function(e){for(var t=0;t<this.rawCodeRegexs.length;t++)if(this.rawCodeRegexs[t].test(e))return!0;return!1},isForcedReturnCode:function(e){return"="===e[0]},isForcedReturnRawCode:function(e){return"."===e[0]},isComment:function(e){return"*"===e[0]},trim:function(e){return e.replace(/^[\s]+/gm,"").replace(/[\s]+$/gm,"")},beauty:function(e){return e.replace(/[\s]+/gm," ")}};var t=function(e,t){this.func=e,this.source=t};t.prototype={rende:function(e){try{return this.func.call(this,e)}catch(t){throw t.source=this.source,t}},getSource:function(){return this.source},encode:function(e){return e&&e.toString?e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;"):e}};var n={parse:function(n){var r=new e(n);r.run();var i,o=r.getSource();try{i=new Function("self",o)}catch(d){throw d.source=o,d}var s=new t(i,o);return s}};return n});